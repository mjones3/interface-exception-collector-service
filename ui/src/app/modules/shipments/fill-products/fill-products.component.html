<div class="flex flex-col flex-auto space-y-1">
    <rsa-process-header
      [subTitle]="header.subTitle | async "
      [title]="header.title | async "
      [buttons]="actionButtonsTpl"
    ></rsa-process-header>
  
    <div class="w-full flex flex-row space-x-8 p-4">
      <div class="flex flex-col flex-auto space-y-3 w-9/12">
        <fuse-card class="flex flex-row space-x-6 items-center p-6">
          <div class="flex flex-row space-x-2">
            <span class="text-left font-bold">Quantity:</span>
            <span class="text-left font-bold">
              <span>( <span id="filledProductsCountId">{{ filledProductsData?.length }} </span> of
                <span id="prodQtyId">{{ quantity }}</span>)</span
              >
            </span>
          </div>
          <div class="flex flex-col flex-auto">
            <mat-progress-bar
              id="productsFilledProgressBar"
              class="h-2"
              mode="determinate"
              [value]="((filledProductsData?.length || 0) / quantity) * 100"
            ></mat-progress-bar>
          </div>
        </fuse-card>
        <div class="flex flex-col flex-grow-0">
          
          <rsa-description-card
            [descriptions]="prodInfoDescriptions"
            [labelClasses]="'min-w-40'"
            [showColon]="true"
            [embedded]="true"
            [maxRows]="2"
            [image]="prodIcon"
          ></rsa-description-card>
        </div>
  
        <fuse-card class="flex flex-col space-y-2 flex-auto w-full">
          <rsa-enter-unit-number-product-code
            #productSelection
            (unitNumberProductCodeSelected)="unitNumberProductCodeSelected($event)"
          ></rsa-enter-unit-number-product-code>
  
          <fuse-card class="flex-col m-8 pb-4">
            <div class="fuse-card-title">
              <div class="flex flex-row w-full justify-between items-center px-5">
                <h3>Filled Products</h3>
              </div>
            </div>
            <mat-divider></mat-divider>
  
            <div class="table-wrapper">
              <p-table
                #productTable
                id="prodTableId"
                dataKey="id"
                styleClass="p-datatable-customers p-datatable-sm"
                [value]="filledProductsData"
                [loading]="loading"
              >
                <ng-template pTemplate="header">
                  <tr>
                    <th class="w-8"></th>
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        Unit Number
                      </div>
                    </th>
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        Product Code
                      </div>
                    </th>
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        Description
                      </div>
                    </th>
                    <th>
                      <div class="p-d-flex p-jc-between p-ai-center">
                        Visual Inspection
                      </div>
                    </th>
                    <th></th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-product let-i="rowIndex">
                  <tr>
                    <td></td>
                    <td>
                      {{ product?.unitNumber }}
                    </td>
                    <td>
                      {{ product?.productCode }}
                    </td>
                    <td>
                      {{ product?.productDescription }}
                    </td>
                    <td>
                      {{ product?.visualInspection }}
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="footer">
                  <tr>
                    <td class="p-text-right" [attr.colspan]="6">
                      <span class="ml-6">({{ filledProductsData.length }}) Total Products</span>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </fuse-card>
        </fuse-card>
      </div>
      <div class="flex flex-col flex-auto w-3/12">
        <rsa-order-widget-sidebar
          [orderInfoDescriptions]="orderInfoDescriptions"
          [shippingInfoDescriptions]="shippingInfoDescriptions"
        ></rsa-order-widget-sidebar>
      </div>
    </div>
  </div>
  
  <ng-template #actionButtonsTpl>
    <div class="flex flex-row space-x-2">
      <button id="backBtn" class="bg-green-highlighted" mat-flat-button (click)="backToShipmentDetails()">
        Back to Shipment Details
      </button>
    </div>
  </ng-template>
  