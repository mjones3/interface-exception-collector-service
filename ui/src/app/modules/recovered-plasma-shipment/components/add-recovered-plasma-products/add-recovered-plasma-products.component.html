<div class="flex w-full flex-col gap-4">
    <fuse-card class="flex flex-col space-y-2">
        <div class="w-full">
            <biopro-scan-unit-number-product-code
                #scanUnitNumberProductCode
                (validate)="addProduct($event)"
            ></biopro-scan-unit-number-product-code>
        </div>
    </fuse-card>

    <fuse-card
        class="mb-4 flex flex-col px-4 pb-4"
        id="filledProduct-container"
    >
        <div class="mt-2 flex flex-row justify-between">
            <div class="flex flex-col p-2">
                <div>
                    <span class="font-bold text-lg">
                        Added Products (<span id="numberOfProductsAdded">{{
                            cartonDetails()?.packedProducts?.length
                        }}</span>/<span id="prodQtyId">{{
                            cartonDetails()?.maxNumberOfProducts
                        }}</span
                        >)
                    </span>
                </div>
                @if (selectedProducts.length > 0) {
                    <div>
                       <span class="text-lg text-gray-400"> {{ selectedProducts.length}}
                        selected</span>
                    </div>
                }
            </div>
            <div class="flex flex-row gap-5 p-2">
                <biopro-basic-button
                    id="select-all-btn"
                    [label]="
                        selectAllTextRule
                            ? 'Select All'
                            : 'Unselect All'
                    "
                    [disabled]="numberOfProducts === 0"
                    color="primary"
                    class="text-primary"
                    (buttonClicked)="selectAllProducts()"
                >
                </biopro-basic-button>

                <biopro-basic-button
                    id="remove-btn"
                    label="Remove"
                    class="text-accent"
                    [disabled]="numberOfSelectedProducts === 0"
                    color="secondary"
                    (buttonClicked)="removeSelectedProducts()"
                >
                </biopro-basic-button>
            </div>
        </div>
        <mat-divider></mat-divider>
        <div
            id="optionButtons"
            class="grid max-h-[520px] grid-cols-4 gap-4 overflow-auto pb-4 pt-4"
        >
            @for (
                option of getPackedProducts();
                track $index
            ) {
                <biopro-unit-number-card
                    [id]="'unit-' + $index"
                    class="max-h-24"
                    [unitNumber]="option.unitNumber"
                    [productName]="option.productCode"
                    [active]="selectedProducts.includes(option)"
                    (clickEvent)="toggleProduct(option)"
                    [iconName]="getItemIcon(option.productType)"
                ></biopro-unit-number-card>
            }
        </div>
    </fuse-card>
</div>
