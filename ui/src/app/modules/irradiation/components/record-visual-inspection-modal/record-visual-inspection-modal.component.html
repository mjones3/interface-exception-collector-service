@if ($reasons | async; as _reasons) {
    <h1 mat-dialog-title class="text-3xl">Record Inspection</h1>
    <mat-dialog-content class="mat-typography">
        <form [formGroup]="form">
            <div class="flex flex-col gap-8">
                <h2>
                    Record the visual inspection of the selected product(s).
                </h2>
                <div class="flex flex-col gap-2">
                    <p class="font-bold">
                        Visual Inspection
                        <span class="required-field-asterisk">*</span>
                    </p>
                    <div class="flex w-full flex-row gap-2">
                        <biopro-action-button
                            id="satisfactoryBtn"
                            btnId="satisfactoryActionBtn"
                            label="Satisfactory"
                            [color]="visualInspection ? 'primary' : 'secondary'"
                            (clickEvent)="visualInpsection = true"
                        ></biopro-action-button>
                        <biopro-action-button
                            id="unsatisfactoryBtn"
                            btnId="unsatisfactoryActionBtn"
                            label="Unsatisfactory"
                            [color]="
                                visualInspection === false
                                    ? 'primary'
                                    : 'secondary'
                            "
                            (clickEvent)="visualInpsection = false"
                        ></biopro-action-button>
                    </div>
                </div>

                @if (visualInspection === false) {
                    <div class="flex flex-col gap-2">
                        <p class="font-bold">
                            Select the reasons
                            <span class="required-field-asterisk">*</span>
                        </p>
                        <mat-grid-list cols="4" rowHeight="5:3" gutterSize="10">
                            @for (reason of _reasons; track reason.reasonKey) {
                                <mat-grid-tile>
                                    <biopro-action-button
                                        [id]="reason.reasonKey"
                                        [btnId]="reason.reasonKey + 'actionBtn'"
                                        [label]="
                                            (
                                                reason.reasonKey
                                                | lowercase
                                                | titlecase
                                            ).replace('_', ' ')
                                        "
                                        [color]="
                                            reasons.value.includes(reason)
                                                ? 'primary'
                                                : 'secondary'
                                        "
                                        (clickEvent)="toggleButton(reason)"
                                        class="w-32"
                                    ></biopro-action-button>
                                </mat-grid-tile>
                            }
                        </mat-grid-list>
                    </div>
                }

                <div class="flex flex-col gap-2">
                    <mat-form-field>
                        <mat-label>Comments</mat-label>
                        <textarea
                            id="commentTextArea"
                            formControlName="comments"
                            matInput
                            [required]="commentRequired"
                        ></textarea>
                    </mat-form-field>
                </div>
            </div>
        </form>
    </mat-dialog-content>
    <mat-dialog-actions align="end" class="space-x-6">
        <biopro-action-button
            id="cancelBtn"
            btnId="cancelActionBtn"
            label="Cancel"
            color="secondary"
            mat-dialog-close
        ></biopro-action-button>
        <biopro-action-button
            id="submitBtn"
            btnId="submitActionBtn"
            label="Submit"
            [disabled]="form.invalid"
            (clickEvent)="submit()"
        ></biopro-action-button>
    </mat-dialog-actions>
} @else {
    <ng-template #loading><p class="text-3xl">loading...</p></ng-template>
}
