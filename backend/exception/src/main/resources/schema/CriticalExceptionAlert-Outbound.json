{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.biopro.arcone.com/events/CriticalExceptionAlert/v1.0.0",
  "title": "Critical Exception Alert Event",
  "description": "High-priority alert for critical exceptions requiring immediate attention",
  "type": "object",
  "required": [
    "eventId",
    "eventType",
    "eventVersion",
    "occurredOn",
    "source",
    "payload"
  ],
  "properties": {
    "eventId": {
      "type": "string",
      "format": "uuid"
    },
    "eventType": {
      "type": "string",
      "const": "CriticalExceptionAlert"
    },
    "eventVersion": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+$"
    },
    "occurredOn": {
      "type": "string",
      "format": "date-time"
    },
    "source": {
      "type": "string",
      "const": "exception-collector-service"
    },
    "correlationId": {
      "type": "string",
      "format": "uuid"
    },
    "payload": {
      "type": "object",
      "required": [
        "exceptionId",
        "transactionId",
        "alertLevel",
        "alertReason"
      ],
      "properties": {
        "exceptionId": {
          "type": "integer",
          "format": "int64"
        },
        "transactionId": {
          "type": "string",
          "format": "uuid"
        },
        "alertLevel": {
          "type": "string",
          "enum": ["HIGH", "CRITICAL", "EMERGENCY"],
          "description": "Severity level of the alert"
        },
        "alertReason": {
          "type": "string",
          "enum": [
            "CRITICAL_SEVERITY", 
            "MULTIPLE_RETRIES_FAILED",
            "SYSTEM_ERROR",
            "CUSTOMER_IMPACT",
            "SLA_BREACH"
          ],
          "description": "Reason for generating critical alert"
        },
        "interfaceType": {
          "type": "string",
          "enum": ["ORDER", "COLLECTION", "DISTRIBUTION"]
        },
        "exceptionReason": {
          "type": "string",
          "description": "Original exception reason"
        },
        "customerId": {
          "type": "string"
        },
        "customersAffected": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of customers affected by this exception pattern"
        },
        "estimatedImpact": {
          "type": "string",
          "enum": ["LOW", "MEDIUM", "HIGH", "SEVERE"],
          "description": "Estimated business impact"
        },
        "requiresImmediateAction": {
          "type": "boolean",
          "description": "Whether this alert requires immediate response"
        },
        "escalationTeam": {
          "type": "string",
          "enum": ["OPERATIONS", "ENGINEERING", "CUSTOMER_SUCCESS", "MANAGEMENT"],
          "description": "Team that should handle this alert"
        },
        "similarExceptionsCount": {
          "type": "integer",
          "description": "Number of similar exceptions in last hour"
        },
        "recommendedActions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Suggested actions to resolve the issue"
        },
        "slaBreach": {
          "type": "object",
          "properties": {
            "breached": {
              "type": "boolean"
            },
            "slaTarget": {
              "type": "string",
              "description": "Target SLA time"
            },
            "actualTime": {
              "type": "string",
              "description": "Actual time elapsed"
            }
          }
        }
      }
    }
  },
  "examples": [
    {
      "eventId": "550e8400-e29b-41d4-a716-446655440015",
      "eventType": "CriticalExceptionAlert",
      "eventVersion": "1.0",
      "occurredOn": "2025-08-04T10:45:00Z",
      "source": "exception-collector-service",
      "payload": {
        "exceptionId": 12347,
        "transactionId": "550e8400-e29b-41d4-a716-446655440016",
        "alertLevel": "CRITICAL",
        "alertReason": "MULTIPLE_RETRIES_FAILED",
        "interfaceType": "ORDER",
        "exceptionReason": "Database connection timeout",
        "customerId": "CUST001",
        "customersAffected": 15,
        "estimatedImpact": "HIGH",
        "requiresImmediateAction": true,
        "escalationTeam": "ENGINEERING",
        "similarExceptionsCount": 23,
        "recommendedActions": [
          "Check database connectivity",
          "Review connection pool settings",
          "Contact infrastructure team"
        ],
        "slaBreach": {
          "breached": true,
          "slaTarget": "15 minutes",
          "actualTime": "45 minutes"
        }
      }
    }
  ]
}
