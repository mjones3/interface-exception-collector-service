{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.biopro.arcone.com/events/CollectionRejected/v1.0.0",
  "title": "Collection Rejected Event", 
  "description": "Event published when a collection request is rejected",
  "type": "object",
  "required": [
    "eventId",
    "eventType",
    "eventVersion",
    "occurredOn", 
    "source",
    "payload"
  ],
  "properties": {
    "eventId": {
      "type": "string",
      "format": "uuid"
    },
    "eventType": {
      "type": "string",
      "const": "CollectionRejected"
    },
    "eventVersion": {
      "type": "string", 
      "pattern": "^\\d+\\.\\d+$"
    },
    "occurredOn": {
      "type": "string",
      "format": "date-time"
    },
    "source": {
      "type": "string",
      "const": "collection-service"
    },
    "correlationId": {
      "type": "string",
      "format": "uuid"
    },
    "payload": {
      "type": "object",
      "required": [
        "transactionId",
        "collectionId",
        "operation",
        "rejectedReason"
      ],
      "properties": {
        "transactionId": {
          "type": "string",
          "format": "uuid"
        },
        "collectionId": {
          "type": "string",
          "description": "External collection identifier"
        },
        "operation": {
          "type": "string",
          "enum": ["CREATE_COLLECTION", "MODIFY_COLLECTION"],
          "description": "Operation that was attempted"
        },
        "rejectedReason": {
          "type": "string",
          "description": "Human-readable rejection reason"
        },
        "donorId": {
          "type": "string",
          "description": "Donor identifier"
        },
        "locationCode": {
          "type": "string",
          "description": "Collection location"
        },
        "collectionDate": {
          "type": "string",
          "format": "date",
          "description": "Scheduled collection date"
        },
        "collectionType": {
          "type": "string",
          "enum": ["WHOLE_BLOOD", "PLATELET", "PLASMA"],
          "description": "Type of collection"
        }
      }
    }
  },
  "examples": [
    {
      "eventId": "550e8400-e29b-41d4-a716-446655440005",
      "eventType": "CollectionRejected", 
      "eventVersion": "1.0",
      "occurredOn": "2025-08-04T11:00:00Z",
      "source": "collection-service",
      "payload": {
        "transactionId": "550e8400-e29b-41d4-a716-446655440006",
        "collectionId": "COLL-ABC123",
        "operation": "CREATE_COLLECTION",
        "rejectedReason": "Donor not eligible for collection",
        "donorId": "DONOR001",
        "locationCode": "LOC456",
        "collectionDate": "2025-08-05",
        "collectionType": "WHOLE_BLOOD"
      }
    }
  ]
}
